---
title: "ST_512-homework2"
author: "Lindsay Dodson"
format: pdf
---

## Problem 1

|            |     |       |        |         |         |
|------------|-----|-------|--------|---------|---------|
| source     | df  | SS    | MS     | F-value | p-value |
| dosage/trt | 2   | 450.7 | 225.35 | 7.031   | 0.0145  |
| error      | 9   | 288.2 | 32.02  |         |         |
| total      | 11  | 738.9 | 257.4  |         |         |

: Lindsay Dodson

```{r}
# f-value
f1<- qf(1-.05, 2, 9)

1-(pf(7.031,2,9))
```

**a** 

Because p=0.0145 < alpha=0.05, we reject the null hypothesis and have evidence to conclude that dosage level does affect bioactivity.

**b**

```{r}
t_val1<-qt(.975,9)
point_est1<- 36.75
SE1<- sqrt(32.02/4)

point_est1 - t_val1*SE1
point_est1 + t_val1*SE1
```

The 95% confidence interval is (30.34965, 43.15035).

**c**

```{r}
t_val2<-qt(.995, 9)
point_est2<- 44.75-29.75
SE2<- sqrt((32.02)*((1/4)+(1/4)))

point_est2 - t_val2*SE2
point_est2 + t_val2*SE2
```

The 99% confidence interval is (1.996596, 28.0034).

**d**

```{r}
#Standard Error 
SE3<-sqrt((32.02/4)*2)

#Point Estimate (from part c)
point_est2

#Tukeys
tuk_1<-(qtukey(1-0.05, 3, 9))/sqrt(2) #critical value
tuk_1*SE3 #margin of error

point_est2+(tuk_1*SE3) #Confidence interval
point_est2-(tuk_1*SE3)

#Bonferroni
bon_1<-qt(1-(0.05/6),9) #CV
bon_1*SE3 #MoE

point_est2+(bon_1*SE3) #CI
point_est2-(bon_1*SE3)

#Scheffe's
schaf_1<- sqrt((qf(1-0.05,2,9))*2) #CV
schaf_1*SE3 #MoE

point_est2+(schaf_1*SE3) #CI
point_est2-(schaf_1*SE3)

```

Confidence Intervals

Tukey: (3.828488, 26.17151)

Bonferroni: (3.263038, 26.73696)

Scheffe's: (3.325542, 26.67446)

**e**

Tukey's HSD = $Q*\sqrt{\frac{MSE}{n}}$ where n=2, Q=2.79, MSE=32.02

HSD=11.16

1 vs 3: $|29.75-44.75|=15 > 11.16$ different

1 vs 2: $|29.75-36.75|=7 < 11.16$ not different

2 vs 3: $|36.75-44.75|=8 < 11.16$ not different

## Problem 2

```{r}
strength<- c(3129, 3000, 2865, 2890, 3200, 3300, 2975, 3150, 2800, 2900, 2985, 3050, 2600, 2700, 2600, 2765) 
mix_tech<- factor(rep(c("1", "2", "3", "4"), each = 4))
Portland_data <- data.frame(mix_tech, strength)
print(Portland_data)

anova_model <- aov(strength ~ mix_tech, data = Portland_data)
summary(anova_model)
```

**a**

Because the p-value=0.0005\<\<alpha=0.05, we reject the null hypothesis and have strong evidence to conclude that the mixing techniques affect the strength of the cement.

**b** 

```{r}
mean_mix3<- 2933.75
mix_CV<- qt(0.975, 12) # two tail test?
SE_mix<- sqrt(12826/4) 

mean_mix3 - (mix_CV*SE_mix)
mean_mix3 + (mix_CV*SE_mix)
```

The confidence interval is (2810.373, 3057.127)

**c**

```{r}
## techniques 1 & 3
SE_mixdif <- sqrt((12826/4)*2)
mean_mix1 <- 2971.00
PE_13<- (mean_mix1-mean_mix3)

PE_13 - (mix_CV*SE_mixdif)
PE_13 + (mix_CV*SE_mixdif)

## techniques 3 & 4
mean_mix4 <- 2666.25
PE_34<- (mean_mix3-mean_mix4)

PE_34 - (mix_CV*SE_mixdif)
PE_34 + (mix_CV*SE_mixdif)
```

The confidence interval for techniques 1 & 3 is (-137.232, 211.732).

The confidence interval for techniques 3 & 4 is (93.01803, 441.982).

**d**

```{r}
#Tukey's
tuk_portland<-(qtukey(1-0.05, 4, 12))/sqrt(2) #can we use the same SE ? sd is the same for all groups, so that would make SE 0 if not using MSE/n forumla
tuk_portland*SE_mixdif
PE_13-(tuk_portland*SE_mixdif)
PE_13+(tuk_portland*SE_mixdif)

#Bonferroni
bon_portland<- qt((1-.0041667),12)
bon_portland*SE_mixdif

PE_13-(bon_portland*SE_mixdif)
PE_13+(bon_portland*SE_mixdif)

#Scheffe's
sch_portland<- sqrt(3*qf(1-0.05,3,12))
sch_portland*SE_mixdif

PE_13-(sch_portland*SE_mixdif)
PE_13+(sch_portland*SE_mixdif)
```

Tukey's CI: (-200.5032, 275.0032)

Bonferroni CI: (-215.2202, 289.7202)

Scheffe's CI: (-221.8827, 296.3827)

**e**

```{r}
bon_portland*SE_mixdif
```

**f**

```{r}
tuk_portland*SE_mixdif
```

**g**

```{r}
sch_portland*SE_mixdif
```

## Problem 3

**Contrast 1:**

$L_1=(1)\mu_1+(-\frac{1}{3})\mu_2+(-\frac{1}{3})\mu_3+(-\frac{1}{3})\mu_4=0$

$\hat{L}=\bar{y}_1\cdot-\frac{\bar{y}_2\cdot+\bar{y}_3\cdot+\bar{y}_4\cdot}{3}=1.867$

$sd(\hat{L_2})=MSE*\sum\frac{c_i^2}{n_i} = 196.0*0.067=13.07$


**Contrast 2:**

$L_1=(1)\mu_2+(-\frac{1}{2})\mu_3+(-\frac{1}{2})\mu_4=0$

$\hat{L}=\bar{y}_2\cdot-\frac{\bar{y}_3\cdot+\bar{y}_4\cdot}{2}=1.6$

$sd(\hat{L_2})=MSE*\sum\frac{c_i^2}{n_i} = 196.0*0.075=14.7$


**Contrast 3:**

$L_1=(1)\mu_3+(-1)\mu_4=0$

$\hat{L}=\bar{y}_3\cdot-\bar{y}_4\cdot=1.6$

$sd(\hat{L_2})=MSE*\sum\frac{c_i^2}{n_i} = 196.0*0.1=19.6$

## Problem 4

```{r}
#| warning: false 
#| message: false
library(dplyr)
library(tidyverse)
library(broom)

radon_release<-c(80,83,83,85,75,75,79,79,74,73,76,77,67,72,74,74,62,62,67,69,60,61,64,66)
diameter<-c(rep("0.37",4),rep("0.51",4),rep("0.71",4),rep("1.02",4),rep("1.40",4),rep("1.99",4))
radon_data<-data.frame(radon_release,diameter)
radon_data
str(radon_data)

```

**a**

Use a one-way ANOVA.

Response variable: radon released

Factors: orifice diameter

Factor Levels: 0.37, 0.51, 0.71, 1.02, 1.40, 1.99

**b**

```{r}
radon_data|>
  group_by(diameter) |>
  summarise(mean_radon=mean(radon_release), std_dev=sd(radon_release))
```

**c**

```{r}
anova_radon <- aov(radon_release~diameter, data=radon_data)
summary(anova_radon)
```

The p-value is significantly less than alpha, so we reject the null hypothesis and have strong evidence to conclude that orifice diameter does affect the mean percentage of radon released.

**d**

```{r}
radon_data |>
      ggplot(
        aes(sample = radon_release)) +
      stat_qq() +
      stat_qq_line() +
      facet_wrap(~ diameter) + # grouping variable
      labs(title = "QQ Plots of Radon Release by Diameter",
           x = "Theoretical Quantiles",
           y = "Ordered data",
           subtitle = "Lindsay Dodson") +
      theme_minimal()
```

The linear relationship shown in the qq-plots, which is what we expect for a normal distribution. There is not enough evidence to conclude the normality assumption is violated.

**e**

```{r}
model1 <- lm(radon_release ~ diameter, data = radon_data)
plot(model1, which = c(1,2))
```
The residuals vs. fitted value shows equally varied points. There is not significant evidence to assume the equal variance assumption is violated. 

**f**

```{r}
#| warning: false 
#| message: false 
library(car)

bartlett.test(radon_release~diameter)

leveneTest(radon_release, diameter)
```
Both the Levene and Barlett tests p-values>0.05, so the data is equally varied and the equal variance assumption is met.


**g**

```{r}
shapiro.test(resid(model1))
```
The p-value>0.05, so the data is approximately normal.

**h**

```{r}
TukeyHSD(anova_radon)
```

The following pairs have p-values that are larger than alpha=0.05, which makes the radon release not different from each other: 0.51-0.37, 0.71-0.51, 1.02-0.51, 1.02-0.71, 1.99-1.40.

```{r}
pairwise.t.test(radon_release,diameter, p.adj="bonferroni")
```

From the Bonferroni adjustment, the following pairs have p-values that are greater than alpha=0.05, which makes the radon release not different from each other: 0.51-0.37, 0.71-0.51, 1.02-0.51, 1.02-0.71.
